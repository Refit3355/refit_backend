<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.refit.app.domain.combination.mapper.CombinationMapper">

    <!-- 조합 기본 정보 조회 -->
    <select id="findCombinationById" parameterType="long" resultType="com.refit.app.domain.combination.dto.response.CombinationResponse">
        SELECT
            c.COMBINATION_ID   AS combinationId,
            c.COMBINATION_NAME AS combinationName,
            c.COMBINATION_DESCRIPTION AS combinationDescription
        FROM COMBINATION c
        WHERE c.COMBINATION_ID = #{combinationId}
    </select>

    <!-- 조합에 속한 상품 목록 조회 -->
    <select id="findProductsByCombinationId" parameterType="long" resultType="com.refit.app.domain.combination.dto.CombinationProductDto">
        SELECT
            p.PRODUCT_ID   AS productId,
            p.PRODUCT_NAME AS productName,
            p.BRAND_NAME   AS brandName,
            p.PRICE        AS price,
            p.DISCOUNT_RATE AS discountRate,
            p.THUMBNAIL_URL AS thumbnailUrl
        FROM COMBINATION_ITEM ci
                 JOIN PRODUCT p ON ci.PRODUCT_ID = p.PRODUCT_ID
        WHERE ci.COMBINATION_ID = #{combinationId}
    </select>

</mapper>
